# Domain Enumeration with PowerView

## Overview

PowerView is a PowerShell tool for the enumeration of Windows domains. The script can be downloaded from https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1.

Before running, you need to bypass PowerShell's execution policy:

```powershell
powershell -ep bypass
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/powershell-ep-bypass.png>)

Load the script using

```powershell
. .\PowerView.ps1
```

Normally, you'd be running these commands through some sort of shell, but for the sake of simplicity, I will show them all run locally.

## Get Domain Information

```powershell
Get-NetDomain
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getnetdomain.png>)

## Get Domain Controller Information

```powershell
Get-NetDomainController
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getnetdomaincontroller.png>)

## Retrieve Domain Policy Information

```powershell
Get-DomainPolicy
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getdomainpolicy.png>)

You can also get information about a specific policy with the following syntax:

```powershell
(Get-DomainPolicy)."policy name"
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getsystemaccessdomainpolicy.png>)

## Get Users Information

```powershell
Get-NetUser
```

The output of this command is rather messy, but you can pull specific information with the following syntax:

```powershell
Get-NetUser | select <property>
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getnetusersamaccname.png>)

However, there is an even better way to do that.

## Get User Property Information

Get a specific properties of all the users:

```powershell
Get-DomainUser -Properties <property1>,<property2>,...
```

It is useful to always have the `samaccountname` as the first property selected, so that you can easily match properties with specific users.

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getdomainuserproperty.png>)

## Get Domain Machines

```powershell
Get-DomainComputer | select samaccountname, operatingsystem
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getdomaincomputers.png>)

## Get Groups

```powershell
Get-NetGroup | select samaccountname, admincount, description
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getdomaingroups.png>)

## Get Group Policy Information

```powershell
Get-NetGPO | select <property1>,<property2>,...
```

![](<../../Post Exploitation/Active Directory (AD)/Resources/Images/getnetgpo.png>)

## Additional Resources

https://book.hacktricks.xyz/windows/basic-powershell-for-pentesters/powerview
