<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js coal">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IPv4 Datagrams - The Cyberclopaedia</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="This is an aspiring project aimed at accumulating knowledge from the world of cybersecurity and presenting it in a cogent way, so it is accessible to as large and audience as possible and so that everyone has a good resource to learn hacking from.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <meta property="og:title" content="IPv4 Datagrams" />
        <meta property="og:image" content="http://cr0mll.github.io/cyberclopaedia/favicon.png" />
        <meta property="og:image:secure_url" content="https://cr0mll.github.io/cyberclopaedia/favicon.png" />
        <meta property="og:description" content="The Cyberclopaedia is an aspiring project aimed at accumulating knowledge from the world of cybersecurity and presenting it in a cogent way, so it is accessible to as large an audience as possible and so that everyone has a good resource to learn hacking from." />

        <meta property="twitter:card" content="summary" />
        <meta property="twitter:site" content="@cr0mll" />
        <meta property="twitter:creator" content="@cr0mll" />
        <meta property="twitter:title" content="IPv4 Datagrams" />
        <meta property="twitter:description" content="The Cyberclopaedia is an aspiring project aimed at accumulating knowledge from the world of cybersecurity and presenting it in a cogent way, so that everyone can learn." />
        <meta property="twitter:image" content="https://cr0mll.github.io/cyberclopaedia/favicon.png" />
        <meta property="twitter:image:alt" content="Cyberclopaedia Logo" />
        

        <link rel="shortcut icon" href="../../../../favicon.png">
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../highlight.css">
        <link rel="stylesheet" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../.././mdbook-admonish.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('coal')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            
            <div class="sidebar-scrollbox">
                <img style="max-width:100%;
max-height:100%; margin-top: 50px" src="../../../../favicon.png" > <!-- Icon pls -->
                <ol class="chapter"><li class="chapter-item "><a href="../../../../Cyberclopaedia/index.html">Cyberclopaedia</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cyberclopaedia/Contributing.html">Contributing</a></li><li class="chapter-item "><a href="../../../../Cyberclopaedia/License.html">License</a></li></ol></li><li class="chapter-item "><a href="../../../../Reconnaissance/index.html">Reconnaissance</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/index.html">Enumeration</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/Port Scanning/index.html">Port Scanning</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/Port Scanning/SYN Scan.html">SYN Scan</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/Port Scanning/TCP Connect Scan.html">TCP Connect Scan</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/Port Scanning/FIN, NULL & XMAS Scans.html">FIN, NULL & XMAS Scans</a></li></ol></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/Web Server Enumeration (80, 443).html">Web Server Enumeration (80, 443)</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/DNS Server Enumeration (53).html">DNS Server Enumeration (53)</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/FTP Enumeration (21).html">FTP Enumeration (21)</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/SNMP Enumeration (161).html">SNMP Enumeration (161)</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/Enumeration/LDAP Enumeration (389, 636, 3268, 3269).html">LDAP Enumeration (389, 636, 3268, 3269)</a></li></ol></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/index.html">OSINT</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Tools/index.html">Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Tools/theHarvester.html">theHarvester</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Tools/recon-ng.html">recon-ng</a></li></ol></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Domain Name Enumeration.html">Domain Name Enumeration</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Harvesting E-Mails.html">Harvesting E-Mails</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Instagram User Enumeration.html">Instagram User Enumeration</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Whois Enumeration.html">Whois Enumeration</a></li><li class="chapter-item "><a href="../../../../Reconnaissance/OSINT/Google Dorks.html">Google Dorks</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Exploitation/index.html">Exploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/index.html">Binary Exploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Heap Exploitation/index.html">Heap Exploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Heap Exploitation/Use After Free (UAF).html">Use After Free (UAF)</a></li></ol></li><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/index.html">Stack Exploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/Format String Vulnerabilities.html">Format String Vulnerabilities</a></li><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/Protection Mechanisms.html">Protection Mechanisms</a></li><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/Return to _dl_resolve.html">Return to _dl_resolve</a></li><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/Return-oriented programming (ROP).html">Return-oriented programming (ROP)</a></li><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/Sigreturn-oriented Programming (SROP).html">Sigreturn-oriented Programming (SROP)</a></li><li class="chapter-item "><a href="../../../../Exploitation/Binary Exploitation/Stack Exploitation/Buffer Overflows.html">Buffer Overflows</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Exploitation/Web/index.html">Web</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Web/SQL Injection/index.html">SQL Injection</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Web/SQL Injection/Finding SQLi.html">Finding SQLi</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/SQL Injection/Defences.html">Defences</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/SQL Injection/Introduction.html">Introduction</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/SQL Injection/Union injections.html">Union injections</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/SQL Injection/Cheatsheets.html">Cheatsheets</a></li></ol></li><li class="chapter-item "><a href="../../../../Exploitation/Web/Template Injection.html">Template Injection</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/Open Redirect.html">Open Redirect</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/PHP Object Injection.html">PHP Object Injection</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/HTTP Response Splitting.html">HTTP Response Splitting</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/CRLF Injection.html">CRLF Injection</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/Cross-Site Scripting (XSS).html">Cross-Site Scripting (XSS)</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/Cross-Site Request Forgery.html">Cross-Site Request Forgery</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/File Inclusion.html">File Inclusion</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/WebSockets.html">WebSockets</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/Directory Traversal.html">Directory Traversal</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/HTTP Parameter Pollution.html">HTTP Parameter Pollution</a></li><li class="chapter-item "><a href="../../../../Exploitation/Web/Host Header Injection.html">Host Header Injection</a></li></ol></li><li class="chapter-item "><a href="../../../../Exploitation/Windows/index.html">Windows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/Windows/SCF File Attacks.html">SCF File Attacks</a></li></ol></li><li class="chapter-item "><a href="../../../../Exploitation/DNS/index.html">DNS</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Exploitation/DNS/DNS Traffic Amplification.html">DNS Traffic Amplification</a></li><li class="chapter-item "><a href="../../../../Exploitation/DNS/DNS Cache Poisoning.html">DNS Cache Poisoning</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/index.html">Post Exploitation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/index.html">Privilege Escalation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/index.html">Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/Abusing SUID & SGID Binaries.html">Abusing SUID & SGID Binaries</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/Kernel Exploits.html">Kernel Exploits</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/Sudo Shell Escape Sequences.html">Sudo Shell Escape Sequences</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/NFS Root Squashing.html">NFS Root Squashing</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/Abusing Linux Capabilities.html">Abusing Linux Capabilities</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Linux/Sudo Escalation via LD_PRELOAD.html">Sudo Escalation via LD_PRELOAD</a></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/index.html">Windows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Misconfigured Services/index.html">Misconfigured Services</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Misconfigured Services/Unquoted Service Paths.html">Unquoted Service Paths</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Misconfigured Services/Weak Registry Permissions.html">Weak Registry Permissions</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Misconfigured Services/Insecure Service Permissions.html">Insecure Service Permissions</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Misconfigured Services/Insecure Service Executable Permissions.html">Insecure Service Executable Permissions</a></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/AutoRun Programmes.html">AutoRun Programmes</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/AlwaysInstallElevated Group Policy.html">AlwaysInstallElevated Group Policy</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Kernel Exploits.html">Kernel Exploits</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Scheduled Tasks.html">Scheduled Tasks</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Bypassing UAC.html">Bypassing UAC</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Startup Applications.html">Startup Applications</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Stored Credentials.html">Stored Credentials</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Privilege Escalation/Windows/Token Impersonation.html">Token Impersonation</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/index.html">Enumeration</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Linux/index.html">Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Linux/Hunting Down Sensitive Files.html">Hunting Down Sensitive Files</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Linux/System Enumeration.html">System Enumeration</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Linux/User Enumeration.html">User Enumeration</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Linux/Network Enumeration.html">Network Enumeration</a></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Windows/index.html">Windows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Enumeration/Windows/System Enumeration.html">System Enumeration</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/Pivoting/index.html">Pivoting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Pivoting/Tunneling with Chisel.html">Tunneling with Chisel</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Pivoting/SSH Tunneling.html">SSH Tunneling</a></li></ol></li><li class="chapter-item "><a href="../../../../Post Exploitation/Active Directory (AD)/index.html">Active Directory (AD)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Post Exploitation/Active Directory (AD)/Domain Enumeration with PowerView.html">Domain Enumeration with PowerView</a></li><li class="chapter-item "><a href="../../../../Post Exploitation/Active Directory (AD)/Domain Data Enumeration with Bloodhound.html">Domain Data Enumeration with Bloodhound</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../System Internals/index.html">System Internals</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../System Internals/Linux/index.html">Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../System Internals/Linux/Processes.html">Processes</a></li><li class="chapter-item "><a href="../../../../System Internals/Linux/File System.html">File System</a></li><li class="chapter-item "><a href="../../../../System Internals/Linux/Command Line.html">Command Line</a></li></ol></li><li class="chapter-item "><a href="../../../../System Internals/Windows/index.html">Windows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/index.html">Active Directory (AD)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/Contacts.html">Contacts</a></li><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/Terminology.html">Terminology</a></li><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/Users.html">Users</a></li><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/Groups.html">Groups</a></li><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/Domain Controllers.html">Domain Controllers</a></li><li class="chapter-item "><a href="../../../../System Internals/Windows/Active Directory (AD)/Computers.html">Computers</a></li></ol></li><li class="chapter-item "><a href="../../../../System Internals/Windows/File System.html">File System</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/index.html">Reverse Engineering</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Program Anatomy/index.html">Program Anatomy</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Program Anatomy/The Stack.html">The Stack</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Program Anatomy/Instructions.html">Instructions</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Program Anatomy/The Heap.html">The Heap</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Program Anatomy/Registers.html">Registers</a></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with Ghidra/index.html">Reverse Engineering with Ghidra</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with Ghidra/Creating a Project and Loading a Binary.html">Creating a Project and Loading a Binary</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with Ghidra/Initial Analysis.html">Initial Analysis</a></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with radare2/index.html">Reverse Engineering with radare2</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with radare2/Analysis.html">Analysis</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with radare2/Strings.html">Strings</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with radare2/Binary Info.html">Binary Info</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with radare2/Flags.html">Flags</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Reverse Engineering with radare2/Seeking.html">Seeking</a></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/index.html">Assembly Programming</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/index.html">x86-64</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/Variables.html">Variables</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/Data Representation.html">Data Representation</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/Addressing Modes.html">Addressing Modes</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/Memory.html">Memory</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/Registers.html">Registers</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly Programming/x86-64/Instruction Set.html">Instruction Set</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/index.html">Binary Formats</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/index.html">PE</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/Relocations.html">Relocations</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/NT Headers.html">NT Headers</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/Sections.html">Sections</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/The Rich Header.html">The Rich Header</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/The DOS Header.html">The DOS Header</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/PE/The DOS Stub.html">The DOS Stub</a></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/index.html">ELF</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/Symbols.html">Symbols</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/Relocations.html">Relocations</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/Sections.html">Sections</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/Segments.html">Segments</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/The ELF Header.html">The ELF Header</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/ELF/Dynamic Linking.html">Dynamic Linking</a></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Binary Formats/Reverse Engineering Android Applications.html">Reverse Engineering Android Applications</a></li></ol></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Assembly.html">Assembly</a></li><li class="chapter-item "><a href="../../../../Reverse Engineering/Basic Reverse Engineering using objdump, strace, and ltrace.html">Basic Reverse Engineering using objdump, strace, and ltrace</a></li></ol></li><li class="chapter-item "><a href="../../../../Hardware Hacking/index.html">Hardware Hacking</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Hardware Hacking/Wireless Attacks/index.html">Wireless Attacks</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Hardware Hacking/Wireless Attacks/Hacking WPA Networks.html">Hacking WPA Networks</a></li><li class="chapter-item "><a href="../../../../Hardware Hacking/Wireless Attacks/Deauth Attack.html">Deauth Attack</a></li><li class="chapter-item "><a href="../../../../Hardware Hacking/Wireless Attacks/Hacking WEP Networks.html">Hacking WEP Networks</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/index.html">Cryptography</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Hash Functions/index.html">Hash Functions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Hash Functions/Birthday Attacks.html">Birthday Attacks</a></li><li class="chapter-item "><a href="../../../../Cryptography/Hash Functions/Merkle-Damgård Transform.html">Merkle-Damgård Transform</a></li><li class="chapter-item "><a href="../../../../Cryptography/Hash Functions/Davies-Meyer Transform.html">Davies-Meyer Transform</a></li><li class="chapter-item "><a href="../../../../Cryptography/Hash Functions/Security Definitions.html">Security Definitions</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Public-Key Cryptography/index.html">Public-Key Cryptography</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Public-Key Cryptography/Security Definitions/index.html">Security Definitions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Public-Key Cryptography/Security Definitions/Perfect Secrecy.html">Perfect Secrecy</a></li><li class="chapter-item "><a href="../../../../Cryptography/Public-Key Cryptography/Security Definitions/Chosen-Plaintext Attack (CPA).html">Chosen-Plaintext Attack (CPA)</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Public-Key Cryptography/Mathematical Prerequisites.html">Mathematical Prerequisites</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Primitives/index.html">Primitives</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Primitives/Pseudorandom Permutations (PRPs).html">Pseudorandom Permutations (PRPs)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Primitives/Pseudorandom Generators (PRGs).html">Pseudorandom Generators (PRGs)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Primitives/Pseudorandom Function Generators (PRFGs).html">Pseudorandom Function Generators (PRFGs)</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/index.html">Private-Key Cryptography</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Stream Ciphers/index.html">Stream Ciphers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Stream Ciphers/Hardware-Oriented Stream Ciphers/index.html">Hardware-Oriented Stream Ciphers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Stream Ciphers/Hardware-Oriented Stream Ciphers/Grain-128a.html">Grain-128a</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/index.html">Security Definitions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Ciphertext-Only Attack (COA)/index.html">Ciphertext-Only Attack (COA)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Ciphertext-Only Attack (COA)/Perfect Secrecy.html">Perfect Secrecy</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Ciphertext-Only Attack (COA)/Semantic Security.html">Semantic Security</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Chosen Plaintext Attack (CPA).html">Chosen Plaintext Attack (CPA)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Randomness.html">Randomness</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Chosen Ciphertext Attack (CCA).html">Chosen Ciphertext Attack (CCA)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/P vs NP.html">P vs NP</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Security Definitions/Ciphertext Integrity (CI).html">Ciphertext Integrity (CI)</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/index.html">Block Ciphers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Modes of Operation/index.html">Modes of Operation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Modes of Operation/Counter (CTR) Mode.html">Counter (CTR) Mode</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Modes of Operation/Cipher Block Chaining (CBC) Mode.html">Cipher Block Chaining (CBC) Mode</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Modes of Operation/Electronic Cookbook (ECB) Mode.html">Electronic Cookbook (ECB) Mode</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Advanced Encryption Standard (AES).html">Advanced Encryption Standard (AES)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Padding Oracle Attack.html">Padding Oracle Attack</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Block Ciphers/Encrypting Non-Conforming Messages.html">Encrypting Non-Conforming Messages</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Message Authentication Codes (MACs)/index.html">Message Authentication Codes (MACs)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Message Authentication Codes (MACs)/Hash-Based MACs (HMAC).html">Hash-Based MACs (HMAC)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Message Authentication Codes (MACs)/Fixed-Length MACs.html">Fixed-Length MACs</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/One-Time Passwords/index.html">One-Time Passwords</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/One-Time Passwords/HMAC-Based One-Time Passwords (HOTP).html">HMAC-Based One-Time Passwords (HOTP)</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/One-Time Passwords/Time-Based One-Time Passwords (TOTP).html">Time-Based One-Time Passwords (TOTP)</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/Authenticated Encryption/index.html">Authenticated Encryption</a></li><li class="chapter-item "><a href="../../../../Cryptography/Private-Key Cryptography/One-Time Pad.html">One-Time Pad</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Integrity Verification/index.html">Integrity Verification</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Integrity Verification/Merkle Trees.html">Merkle Trees</a></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Key Management/index.html">Key Management</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Key Management/Key Exchange/index.html">Key Exchange</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Cryptography/Key Management/Key Exchange/Security Definitions.html">Security Definitions</a></li><li class="chapter-item "><a href="../../../../Cryptography/Key Management/Key Exchange/Diffie-Hellman Key Exchange.html">Diffie-Hellman Key Exchange</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../../Cryptography/Breaking Classical Cryptrography.html">Breaking Classical Cryptrography</a></li><li class="chapter-item "><a href="../../../../Cryptography/Mathematical Prerequisites.html">Mathematical Prerequisites</a></li><li class="chapter-item "><a href="../../../../Cryptography/Computer Science Prerequisites.html">Computer Science Prerequisites</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../Networking/index.html">Networking</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Networking/Protocols/index.html">Protocols</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/index.html">Internet Protocol (IP)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/Internet Protocol v4 (IPv4)/index.html">Internet Protocol v4 (IPv4)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/Internet Protocol v4 (IPv4)/Subnetting.html">Subnetting</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/Internet Protocol v4 (IPv4)/Classful Addressing.html">Classful Addressing</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/Internet Protocol v4 (IPv4)/Classless Inter-Domain Routing (CIDR).html">Classless Inter-Domain Routing (CIDR)</a></li><li class="chapter-item expanded "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/Internet Protocol v4 (IPv4)/IPv4 Datagrams.html" class="active">IPv4 Datagrams</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Internet Protocol (IP)/Internet Protocol v6 (IPv6).html">Internet Protocol v6 (IPv6)</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/index.html">WLAN (IEEE 802.11)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Management Frames/index.html">Management Frames</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Management Frames/Action Frames.html">Action Frames</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Management Frames/Association Frames.html">Association Frames</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Management Frames/Authentication Frames.html">Authentication Frames</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Management Frames/Discovery Frames.html">Discovery Frames</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Data Frames.html">Data Frames</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Control Frames.html">Control Frames</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Authentication & Association.html">Authentication & Association</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/WiFi Protected Access (WPA).html">WiFi Protected Access (WPA)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/WLAN (IEEE 802.11)/Encryption & Integrity.html">Encryption & Integrity</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Domain Name System (DNS)/index.html">Domain Name System (DNS)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Networking/Protocols/Domain Name System (DNS)/The in-addr.arpa Domain.html">The in-addr.arpa Domain</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Domain Name System (DNS)/The Domain Name System.html">The Domain Name System</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Domain Name System (DNS)/DNS Protocol.html">DNS Protocol</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Simple Network Management Protocol (SNMP).html">Simple Network Management Protocol (SNMP)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Leightweight Directory Access Protocol (LDAP).html">Leightweight Directory Access Protocol (LDAP)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Server Message Block (SMB).html">Server Message Block (SMB)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Network Time Protocol (NTP).html">Network Time Protocol (NTP)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/File Transfer Protocol (FTP).html">File Transfer Protocol (FTP)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Address Resolution Protocol (ARP).html">Address Resolution Protocol (ARP)</a></li><li class="chapter-item "><a href="../../../../Networking/Protocols/Ethernet (IEEE 802.3).html">Ethernet (IEEE 802.3)</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Networks/index.html">Networks</a></li><li class="chapter-item "><a href="../../../../Networking/The TCP-IP Suite and the OSI Model/index.html">The TCP-IP Suite and the OSI Model</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../../Networking/The TCP-IP Suite and the OSI Model/(1) The Physical Layer.html">(1) The Physical Layer</a></li><li class="chapter-item "><a href="../../../../Networking/The TCP-IP Suite and the OSI Model/(2) The Datalink Layer.html">(2) The Datalink Layer</a></li></ol></li><li class="chapter-item "><a href="../../../../Networking/Network Address Translation (NAT).html">Network Address Translation (NAT)</a></li><li class="chapter-item "><a href="../../../../Networking/Subnetting.html">Subnetting</a></li><li class="chapter-item "><a href="../../../../Networking/VLANs.html">VLANs</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Cyberclopaedia</h1>

                    <div class="right-buttons">
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/cr0mll/cyberclopaedia/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Packets at the network layer are referred to as <em>datagrams</em>. The IP protocol takes date from the transport layer and encapsulates it by adding to it an <em>IP header</em>. Once this header is added, the packet becomes an IP datagram. This datagram is then passed onto the data link layer.</p>
<h1 id="ip-header"><a class="header" href="#ip-header">IP Header</a></h1>
<p>An IP datagram is divided into an <em>IP header</em> and a <em>payload</em>. The latter contains the transport-layer data which was passed to the network layer, while the former contain information about the datagram itself. </p>
<p>The IP header is a variable-length header with a minimum size of 20 bytes.</p>
<p><img src="Resources/Images/IPv4%20Datagram.svg" alt="" /></p>
<h3 id="version"><a class="header" href="#version">Version</a></h3>
<p>This is a 4-bit field which identifies the IP protocol version used in the datagram. For IPv4, this field is equal to 4. Typically, implementations which run an older version of the IP protocol will reject datagrams which use a newer one, under the assumption that the old implementation might incorrectly handle them.</p>
<h3 id="internet-header-length-ihl"><a class="header" href="#internet-header-length-ihl">Internet Header Length (IHL)</a></h3>
<p>This 4-bit field contains the length (measured in 32-bit words) of the IP header, including options and any padding. The lowest value for this field - when there are no options and thus no padding - is 5 (<code>5*4 = 20</code> bytes in total).</p>
<h3 id="differentiated-service-code-point-dscp--explicit-congestion-notification-ecn"><a class="header" href="#differentiated-service-code-point-dscp--explicit-congestion-notification-ecn">Differentiated Service Code Point (DSCP) &amp; Explicit Congestion Notification (ECN)</a></h3>
<p>These two fields were originally defined as a single <em>Type of Service (TOS)</em> field which was supposed to render quality of service features, such as prioritised delivery. It never saw wide adoption which is why it was redefined as two separate field.</p>
<p>The <em>Differentiated Service Code Point (DSCP)</em> is a 14-bit field which specifies <a href="https://en.wikipedia.org/wiki/Differentiated_services">differentiated services</a>. It is used by data streaming services such as Voice over IP (VoIP).</p>
<p>The <em>Explicit Congestion Notification</em> (ECN) is a 2-bit field which allows for end-to-end notification of network congestion without dropping any datagrams. It is an optional feature available when both the two endpoints and the underlying network support it.</p>
<h3 id="total-length-tl"><a class="header" href="#total-length-tl">Total Length (TL)</a></h3>
<p>This 2-byte field specifies the <em>total length</em> (in bytes) of the IP datagram - IP header + data payload. Its size, 16-bits, determines the maximum size of an IP datagram - 65 535 bytes. If this limit is exceeded, fragmentation occurs. In practice, most datagrams are much smaller.</p>
<h3 id="fragmentation-fields"><a class="header" href="#fragmentation-fields">Fragmentation Fields</a></h3>
<p>The next three fields relate to fragmented datagrams.</p>
<p>The <em>Identification</em> field is 2 bytes in size and contains a value which is shared by all fragments pertaining to a specific message. It is used by the recipient for datagram reassembly in order to avoid different messages getting mixed up. It is important to note that this field is still populated for unfragmented datagrams because they may need to be split up later in the transmission process.</p>
<p>The <em>Flags</em> are 3 bits which control fragmentation.</p>
<p><img src="Resources/Images/IPv4%20Fragmentation%20Flags.svg" alt="" /></p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Flag</th><th style="text-align: center">Meaning</th></tr></thead><tbody>
<tr><td style="text-align: center">Reserved</td><td style="text-align: center">Not used.</td></tr>
<tr><td style="text-align: center">Don't Fragment (DF)</td><td style="text-align: center">When set to 1, it specifies that the datagram should not be fragmanted. In practice, this flag is only used when testing the maximum transmission unit (MTU) of a link.</td></tr>
<tr><td style="text-align: center">More Fragments (MF)</td><td style="text-align: center">A value of 0 indicates that this is the last fragment in the transmission. A value of 1 means that there are more fragments on the way. This bit is always 0 for unfragmented datagrams.</td></tr>
</tbody></table>
</div>
<p>The <em>Fragment Offset</em> field is 13 bits wide and specifies the offset (measured in units of 64 bits or 8 bytes) in the original message  in the original message at which the data from this fragment goes.</p>
<h3 id="time-to-live-ttl"><a class="header" href="#time-to-live-ttl">Time To Live (TTL)</a></h3>
<p>This 1-byte field contains the number of remaining router hops before the datagram is deemed expired. Each router that the datagram passes through decrements the TTL by one and If it reaches 0, the datagram is dropped and an ICMP <em>Time Exceeded</em> message is usually sent back to the sender to inform them.</p>
<p>This mechanism was put in place in order to prevent datagrams from getting stuck in infinite cycles between routers. While it rarely happens, it is possible for a datagram to be forward from router A to router B to router C and then back to A which would result in a loop.</p>
<p>Interestingly, the TTL can sometimes be used for enumerating the operating system - unix-based systems use an initial TTL of 64, while Windows uses 128.</p>
<h3 id="protocol"><a class="header" href="#protocol">Protocol</a></h3>
<p>This 1-byte field indicates the upper-layer protocol encapsulated by the IP datagram. The list of possible values for this field is maintained by IANA.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Value</th><th style="text-align: center">Protocol</th></tr></thead><tbody>
<tr><td style="text-align: center"><code>0x00</code></td><td style="text-align: center">Reserved.</td></tr>
<tr><td style="text-align: center"><code>0x01</code></td><td style="text-align: center">ICMP</td></tr>
<tr><td style="text-align: center"><code>0x02</code></td><td style="text-align: center">IGMP</td></tr>
<tr><td style="text-align: center"><code>0x03</code></td><td style="text-align: center">GGP</td></tr>
<tr><td style="text-align: center"><code>0x04</code></td><td style="text-align: center">IP-in-IP Encapsulation</td></tr>
<tr><td style="text-align: center"><code>0x06</code></td><td style="text-align: center">TCP</td></tr>
<tr><td style="text-align: center"><code>0x08</code></td><td style="text-align: center">EGP</td></tr>
<tr><td style="text-align: center"><code>0x11</code></td><td style="text-align: center">UDP</td></tr>
<tr><td style="text-align: center"><code>0x32</code></td><td style="text-align: center">Encapsulating Security Payload (ESP) Extension Header</td></tr>
<tr><td style="text-align: center"><code>0x33</code></td><td style="text-align: center">Authentication Header (AH) Extension Header</td></tr>
</tbody></table>
</div>
<h3 id="header-checksum"><a class="header" href="#header-checksum">Header Checksum</a></h3>
<p>This 2-byte field contains a value which is calculated by dividing only the IP header into two-byte sections and then summing their values. This is used to provide basic integrity checking - each router the datagram goes through will perform the same calculation on the IP header and if the result does not match with the specified checksum, the datagram will be discarded as corrupted.</p>
<div id="admonition-note" class="admonition admonish-note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note"></a></p>
</div>
<div>
<p>The data does <em>not</em> figure in the calculation of the checksum.</p>
</div>
</div>
<h3 id="source--destination-addresses"><a class="header" href="#source--destination-addresses">Source &amp; Destination Addresses</a></h3>
<p>These are two 4-byte fields representing respectively the source and destination IP addresses. Even though an IP address may be forwarded multiple times through a bunch of routers, the source and destination addresses are unchanged.</p>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<p>The <em>Options</em> field is variable in length and is, well, optional. Every IP header must be at least 20 bytes in size and contains key information. However, additional information can be added via options, thus increasing the header's size. </p>
<p>Each option has the following format:</p>
<p><img src="Resources/Images/IPv4%20Option.svg" alt="" /></p>
<p>The <em>Option Type</em> is an 8-bit field subdivided into three subfields, which are described in the table below.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Subfield</th><th style="text-align: center">Size (in bits)</th><th style="text-align: center">Meaning</th></tr></thead><tbody>
<tr><td style="text-align: center">Copied</td><td style="text-align: center">1</td><td style="text-align: center">If this bit is set to 1, then the option should be copied into all fragments if the datagram is fragmented. A value of 0 indicates that this option should <em>not</em> be copied.</td></tr>
<tr><td style="text-align: center">Option Class</td><td style="text-align: center">2</td><td style="text-align: center">Specifies one of four potential categories the option belongs to. Only two of the values are used - 0 is for <em>Control</em> options and 2 is for <em>Debugging and Measurement</em> options.</td></tr>
<tr><td style="text-align: center">Option Number</td><td style="text-align: center">5</td><td style="text-align: center">Specifies the kind of option. Each of the two available classes has a maximum of 32 different types of options.</td></tr>
</tbody></table>
</div>
<p>The <em>Option Length</em> is only present in variable-length options and indicates the size (in bytes) of the <em>entire</em> option - including the Option Type, Option Data and itself.</p>
<p>The <em>Option Data</em> is only present in variable-length options and stores the data pertinent to the option.</p>
<p>Following is a list of possible IP options. TODO: complete</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Option Name</th><th style="text-align: center">Option Class</th><th style="text-align: center">Option Number</th><th style="text-align: center">Option Length (in bytes)</th><th style="text-align: center">Description</th></tr></thead><tbody>
<tr><td style="text-align: center">End of Options List</td><td style="text-align: center">0</td><td style="text-align: center">0</td><td style="text-align: center">1</td><td style="text-align: center">An option containing a single zero byte which indicates the end of the options list.</td></tr>
<tr><td style="text-align: center">No Operation</td><td style="text-align: center">0</td><td style="text-align: center">1</td><td style="text-align: center">1</td><td style="text-align: center">A dummy option which is used for internal alignment requirements on 32-bit boundaries within the Options field when necessary.</td></tr>
<tr><td style="text-align: center">Security</td><td style="text-align: center">0</td><td style="text-align: center">2</td><td style="text-align: center">11</td><td style="text-align: center">An option for the military to indicate the security classification of IP datagrams.</td></tr>
<tr><td style="text-align: center">Loose Source Route</td><td style="text-align: center">0</td><td style="text-align: center">3</td><td style="text-align: center">Variable</td><td style="text-align: center">Used for source routing.</td></tr>
<tr><td style="text-align: center">Record Route</td><td style="text-align: center">0</td><td style="text-align: center">7</td><td style="text-align: center">Variable</td><td style="text-align: center">Allows for the recording of the datagram's route. Each router the datagram passes through will append its IP address to this option. The maximum size for this route is set by the datagram's origin and so if it fills up, no further addresses will be added to it.</td></tr>
<tr><td style="text-align: center">Strict Source Route</td><td style="text-align: center">0</td><td style="text-align: center">9</td><td style="text-align: center">Variable</td><td style="text-align: center">Used for source routing.</td></tr>
<tr><td style="text-align: center">Timestamp</td><td style="text-align: center">2</td><td style="text-align: center">4</td><td style="text-align: center">Similarly to Record Route, each router the datagram passes through will put a timestamp on it. The maximum size of this option is once again said by the original sender and so no further timestamps will be added after it is exceeded.</td><td style="text-align: center"></td></tr>
<tr><td style="text-align: center">Traceroute</td><td style="text-align: center">2</td><td style="text-align: center">18</td><td style="text-align: center">12</td><td style="text-align: center">Used in the implementation of the traceroute utility.</td></tr>
</tbody></table>
</div>
<h3 id="padding"><a class="header" href="#padding">Padding</a></h3>
<p>The size of the IP header must be a multiple of 32-bits, so padding bits set to 0 may be added following any options in order to fulfil this requirement.</p>
<h1 id="fragmentation"><a class="header" href="#fragmentation">Fragmentation</a></h1>
<p>IPv4 datagrams are ultimately passed onto the data-link layer. Depending on what protocol is employed at that level, the maximum size of a frame, called the <em>Maximum Transmission Unit (MTU)</em>, is limited. The implementation of the IP layer on every device must, therefore, be cognisant of the MTU of the underlying data-link protocol. When an IP datagram is to be transmitted, the IP implementation checks what the size of the datagram would be after the addition of the IP header and if this size exceeds the MTU, then fragmentation is necessary.</p>
<p>This is seen when a datagram passes from a network with a high MTU to a network with a low MTU. Since IP datagrams may hop to and from multiple networks before reaching their ultimate destination, it is common for the fragments of a datagram to themselves get fragmented along the way!</p>
<p>Each router needs to be able to fragment datagrams with a size up to the highest MTU network that the router is connected to. Additionally, every router must support a minimum MTU of 576 bytes, defined in RFC 791, in order to allow for a reasonable message size of 512 bytes including bytes for the IP header.</p>
<h2 id="datagram-disassembly"><a class="header" href="#datagram-disassembly">Datagram Disassembly</a></h2>
<p>When a datagram's size exceeds the MTU of the network it is to be sent through, the datagram needs to be fragmented. The IP header of the first fragment is largest and has a size which we denote by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Each subsequent fragment also gets an IP header, but the size of this header, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, is the same for all fragments, apart from the first one. </p>
<div id="admonition-note-1" class="admonition admonish-note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note-1"></a></p>
</div>
<div>
<p>Datagrams whose size exceeds the MTU but have the <em>Don't Fragment</em> flag set to 1 will be dropped and an ICMP Destination Unreachable: &quot;Fragmentation Needed and Don't Fragment Bit Set&quot; message will be returned to the sender.</p>
</div>
</div>
<p>If we let <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> be the number of bytes the original datagram is made up of, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> be the MTU, then the algorithm for datagram fragmentation can be written as follows:</p>
<ol>
<li>Create the first fragment by taking the first <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> bytes from the IP datagram's data. </li>
<li>Create the next fragments by taking the first <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span> bytes from the remaining data bytes.</li>
<li>Create the last fragment by taking all of the left-over data bytes.</li>
<li>Generate the IP headers
<ul>
<li>IP header of the first fragment - the original IP header is copied into the IP header of the first fragment.</li>
<li>IP header of the subsequent fragments - copy the original IP header but only include the options marked as <em>Copied</em>.</li>
<li>Populate the fields of the IP headers.</li>
</ul>
</li>
</ol>
<p>The <code>Total Length</code> is set to the size of each fragment, not the size of the original message.</p>
<div id="admonition-note-2" class="admonition admonish-note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note-2"></a></p>
</div>
<div>
<p>The size of each fragment must be a multiple of 8 to allow for proper offset calculation.</p>
</div>
</div>
<p>The <code>Identification</code> field is set to a value unique for the message but which is the same for all of the <em>fragments</em> of the message and it is used by the destination to determine which fragments belong to the message.</p>
<p>The <code>More Fragments</code> flag is set to 1 for all the fragments except for the last one where it is set to 0.</p>
<p>The <code>Fragment Offset</code> indicates where a fragment's data is supposed to be in the original datagram. This offset is specified in units of 8 bytes (hence why the length of each fragment must be a multiple of 8).</p>
<div id="admonition-example" class="admonition admonish-example">
<div class="admonition-title">
<p>Example</p>
<p><a class="admonition-anchor-link" href="#admonition-example"></a></p>
</div>
<div>
<p>Suppose we had an MTU of 3300 bytes and a datagram of size 12,000 bytes including the IP header, which, for the sake of simplicity, contained no options and was thus 20 bytes long. Therefore, the size of the actual data will be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">12</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">980</span></span></span></span> bytes.</p>
<p>The first fragment will take the first 3280 bytes of the datagram's data, leaving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">980</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3280</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8700</span></span></span></span> bytes of data.</p>
<p>The second fragment will take the next 3280 bytes of data, leaving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">8700</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3280</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5420</span></span></span></span> bytes.</p>
<p>The third fragment will take the next 3280 bytes of data, leaving <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">5420</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3280</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2140</span></span></span></span> bytes.</p>
<p>The last fragment will take the remaining 2140 bytes.</p>
<p>The <code>Total Length</code> fields of the fragments will be set respectively to 3300, 3300, 3300 and 2160.</p>
<p>The <code>Identification</code> field of all the fragments will be set to the same value, for example <code>0xbeef</code>.</p>
<p>The <code>More Fragments</code> field of the last fragment will be set to 0 and for the rest of the fragments it will be set to 1.</p>
<p>The <code>Fragment Offset</code> for the first fragment will be 0. The second fragment's data begins at an offset of 3280 bytes from the start of the initial datagram's data and so its <code>Fragment Offset</code> will be set to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3280/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">410</span></span></span></span>. The third fragment's data begins at an offset of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3280</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3280</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6560</span></span></span></span> from the original datagram's data and so its <code>Fragment Offset</code> will be set to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">6560/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">820</span></span></span></span>. Finally, the last fragment will have a <code>Fragment Offset</code> equal to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1230</span></span></span></span> because its data begins at an offset of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3280</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9840</span></span></span></span> from the initial datagram's data.</p>
</div>
</div>
<h2 id="datagram-reassembly"><a class="header" href="#datagram-reassembly">Datagram Reassembly</a></h2>
<p>Datagram reassembly is the inverse of the fragmentation process but it is <em>not</em> symmetric. This is because while an intermediate router can fragment a datagram, it cannot reassemble it. Reassembly is only done by the final recipient and follows this algorithm:</p>
<ol>
<li>Fragment Recognition - the recipient knows it has received fragment from a new message when it sees a datagram with <code>More Fragments</code> set to 1 or a <code>Fragment Offset</code> different from zero which has a previously unseen <code>Identification</code> field.</li>
<li>Buffer Initialisation - the recipient initialises a buffer for the new message and populates it with data from message fragments according to their <code>Fragment Offset</code> as they arrive.</li>
<li>Timer Initialisation - the recipient also initialises a timer. Since fragments may get lost and may thus never be received by the recipient, when the timer expires the message is dropped and an ICMP Time Exceeded message is sent back to the sender.</li>
<li>Transmission Completion - the recipient knows it has received the entire message when it has the message fragment with <code>More Fragments</code> set to 0 and the entire buffer is filled up. From this point forward, the message is processed as a normal IP datagram.</li>
</ol>

                    </main>
                </div>
                
            </div>
            
            
        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
